#include QMK_KEYBOARD_H

#define _QWERTY 0
#define _XF86 1
#define _VIM 2
#define _VIM_SH 3
#define _NUM 4
#define _MOUSE 5

#define KC_VIM MO(_VIM)
#define KC_VIM_SH MO(_VIM_SH)
#define KC_NUM MO(_NUM)
#define KC_XF86 MO(_XF86)
#define KC_MOUSE MO(_MOUSE)

enum custom_keycodes {
  QWERTY = SAFE_RANGE,
  VIM_W,
  VIM_B,
  VIM_A,
  VIM_CC,
  VIM_DD,
  VIM,
  NUM,
  XF86,
  MOUSE,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

  [_QWERTY] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     KC_GRV,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,                               KC_6,    KC_7,    KC_8,    KC_9,    KC_0,    KC_MINS,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     LALT_T(KC_TAB),KC_Q,KC_W,  KC_E,    KC_R,    KC_T,                               KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    RALT_T(KC_BSLS),
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     LCTL_T(KC_ESC),KC_A,KC_S,  KC_D,    KC_F,    KC_G,                               KC_H,    KC_J,    KC_K,    KC_L,    KC_SCLN, RCTL_T(KC_QUOT),
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     KC_LSFT, KC_Z,    KC_X,    KC_C,    KC_V,    KC_B,    KC_SPC,           KC_NO,   KC_BSPC, KC_N,    KC_M,    KC_COMM, KC_DOT,  RSFT_T(KC_SLSH),
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    KC_VIM,  KC_LGUI, KC_NO,                     KC_ENT,  KC_RGUI, KC_XF86
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  ),

  [_XF86] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     TG(_MOUSE),KC_F1, KC_F2,   KC_F3,   KC_F4,   KC_F5,                              KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_F10,  _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     TG(_NUM), _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     TG(_VIM), _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______, _______,          _______, _______, _______, _______, _______, _______, _______,
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, _______, _______,                   _______, _______, _______
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  ),

  [_VIM] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     _______, KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,                              KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_HOME, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, VIM_W,   _______, _______, _______,                            _______, _______, TG(_VIM),_______,_______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______,_______,_______,OSL(_VIM_SH),_______,_______,                            KC_LEFT, KC_DOWN, KC_UP, KC_RIGHT,  _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     MO(_VIM_SH),_______,_______,OSL(_VIM_SH),_______,VIM_B,_______,         _______, _______, _______, _______, _______, _______, MO(_VIM_SH),
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, _______, _______,                   _______, _______, _______
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  ),

  [_VIM_SH] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     _______, _______, _______, _______, KC_END,  _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, VIM_A,   _______, VIM_DD,  _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, VIM_CC,  _______, _______, _______,          _______, _______, _______, _______, _______, _______, _______,
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, _______, _______,                   _______, _______, _______
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  ),

  [_NUM] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     _______, KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,                              KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_F10,  _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______,                            _______, KC_P7,   KC_P8,   KC_P9,   _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     TG(_NUM),_______, _______, _______, _______, _______,                            _______, KC_P4,   KC_P5,   KC_P6,   _______, TG(_NUM),
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     _______, _______, _______, _______, _______, _______, _______,          _______, _______, KC_P1,   KC_P2,   KC_P3,   _______, _______,
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, _______, _______,                   KC_P0,   _______, _______
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  ),

  [_MOUSE] = LAYOUT(
  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     _______, KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,                              KC_F6,   KC_F7,   KC_BTN2, KC_F9,   KC_F10,  _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     KC_ACL0, _______, _______, _______, _______, _______,                            _______, KC_WH_D, KC_WH_U, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     TG(_MOUSE),_______,_______,_______, _______, _______,                            KC_MS_L, KC_MS_D, KC_MS_U, KC_MS_R, _______, TG(_MOUSE),
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     KC_ACL1, _______, _______, _______, _______, _______, _______,          _______, _______, KC_BTN1, KC_BTN3, _______, _______, _______,
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, _______, _______,                   KC_ACL0, KC_ACL1, KC_ACL2
                                // └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  )

  /* [_XF86] = LAYOUT( */
  /* //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐ */
  /*    _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______, */
  /* //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤ */
  /*    _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______, */
  /* //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤ */
  /*    _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______, */
  /* //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤ */
  /*    _______, _______, _______, _______, _______, _______, _______,          _______, _______, _______, _______, _______, _______, _______, */
  /* //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘ */
  /*                                   _______, _______, _______,                   _______, _______, _______ */
  /*                               // └────────┴────────┴────────┘                 └────────┴────────┴────────┘ */
  /* ) */

};

const uint16_t PROGMEM brackLeft[] = {KC_H, KC_J, COMBO_END};
const uint16_t PROGMEM brackRight[] = {KC_J, KC_K, COMBO_END};
const uint16_t PROGMEM zero[] = {KC_K, KC_L, COMBO_END};
const uint16_t PROGMEM dash[] = {KC_L, KC_SCLN, COMBO_END};
const uint16_t PROGMEM equal[] = {KC_O, KC_P, COMBO_END};
combo_t key_combos[COMBO_COUNT] = {
    COMBO(brackLeft, KC_LBRC),
    COMBO(brackRight, KC_RBRC),
    COMBO(zero, KC_0),
    COMBO(dash, KC_MINS),
    COMBO(equal, KC_EQL)
};

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    switch (keycode) {

    case VIM_A:
        if (record->event.pressed) {
            register_code(KC_END);
            unregister_code(KC_END);
            layer_off(_VIM);
        }
        break;

    case VIM_B:
        if (record->event.pressed) {
            register_code(KC_LCTL);
            register_code(KC_LEFT);
            unregister_code(KC_LEFT);
            unregister_code(KC_LCTL);
        }
        break;

    case VIM_W:
        if (record->event.pressed) {
            register_code(KC_LCTL);
            register_code(KC_RIGHT);
            unregister_code(KC_RIGHT);
            unregister_code(KC_LCTL);
        }
        break;

    case VIM_CC:
        if (record->event.pressed) {
            register_code(KC_HOME);
            unregister_code(KC_HOME);
            register_code(KC_LSFT);
            register_code(KC_END);
            unregister_code(KC_END);
            unregister_code(KC_LSFT);
            register_code(KC_DEL);
            unregister_code(KC_DEL);
            layer_off(_VIM);
        }
        break;

    case VIM_DD:
        if (record->event.pressed) {
            register_code(KC_HOME);
            unregister_code(KC_HOME);
            register_code(KC_LSFT);
            register_code(KC_END);
            unregister_code(KC_END);
            unregister_code(KC_LSFT);
            register_code(KC_DEL);
            unregister_code(KC_DEL);
        }
        break;

    /* case EXAMPLE: */
    /*     if (record->event.pressed) { */
    /*         /1* SEND_STRING(SS_DOWN(X_LCTL) X_LEFT SS_UP(X_LCTL)); *1/ */
    /*     } else { */
    /*         // when keycode VIM_W is released */
    /*     } */
    /*     break; */

    }
    return true;
};
